.\" Manpage for getip.


.TH GETIP 1 "29 Sep 2015" "1.0" "GETIP VERSION 1.0"

.SH NAME

getip \- retrieves the WAN IP address (the external IP address).

.SH SYNOPSIS

\fBgetip\fR [-m | -f | -c | -u url] [-n num_sources] [-t timeout_secs] [-b | -v] [-h]

In typical usage no options are necessary.

.SH REQUIREMENTS

getip is a \fBBASH\fR script which requires either \fBwget\fR or \fBcurl\fR to be installed. Most modern UNIX like systems come with wget pre-installed. wget and curl are both command line programs which can fetch web pages from the Internet. getip works equally well with them both (wget is used by default if both programs are available on the system). If neither are installed the user will be given an error message telling them to install one of them.

.SH DESCRIPTION

getip is a script used to retrieve the WAN IP address (the external IP address) from behind a router using web pages (sources) which provide the IP address of the 'visitor' in HTML. By default getip fetches two of these web pages and extracts the IP address from them both, it makes sure they are the same IP address and, if so, the IP address is echoed to the terminal (stdout).

From time to time a web page used as a source will stop providing IP addresses, either temporarily or permanently, but an example IP address might remain on the page, or an IP-like software version number might be present, embedded in the HTML, and which could be mistaken for a real IP address (although the script tries hard to spot version numbers so they can be ignored). In such cases an IP address fetching script could provide a user with an incorrect IP address. getip uses multi mode by default to prevent this from happening.

In multi mode the IP address is retrieved from multiple sources (default: 2) and compared, so that the correct IP address can be provided. Users are advised to use multi mode in preference to fast mode.

The getip script retrieves IPv4 addresses only and not IPv6 addresses.

This script currently contains over 100 web sources.

The list of web sources is randomized every time the script is run. This is so that undue pressure is not placed on servers near the top of the list. The randomizing process is done very quickly and does not have a significant impact on the running time of the script.

.SH OPTIONS
.BR
In typical usage no options are necessary.
.BR

.TP
\fB\-m\fR
Multi mode (default); fetch the IP address from multiple sources and check that they are all the same. In multi mode the default number of sources to use is 2. This is the default mode so \fB\-m\fR is optional. See: \fB\-n\fR \fBnum_sources\fR

.TP
\fB\-f\fR
Fast mode; fetch the IP address from just one source in order to retrieve it more quickly than in multi mode. Fast mode is not guaranteed to be faster than multi mode but on average it will be slightly quicker. It is suggested that users only use fast mode to confirm their IP address when it is already known, e.g. checking a VPN connection. In some circumstances an incorrect IP address can be returned in fast mode, see \fBDescription\fR section above.

.TP
\fB\-c\fR
Check mode; displays a table containing the url of each source, the IP address that it returned (or a failure message), the time taken to retrieve the IP address, and various statistics. Used to test the sources list.

.TP
\fB\-u\fR \fBurl\fR
Test Url mode; tests an url for possible inclusion in the sources list. It will display a small table of helpful information, including the IP address and whether the url returned a single IP address (which is required for inclusion in the sources list), multiple IP addresses, or no IP addresses at all. The "http://" protocol part of the url is required.

.TP
\fB\-n\fR \fBnum_sources\fR
Sets the Number of sources to use in multi mode. The allowed range of values is >=2 and <=5. The default value is 2.

.TP
\fB\-t\fR \fBnum_seconds\fR
Sets the Timeout for each source. When a source gives no response or is slow to respond getip moves on to the next source, \fB\-t\fR sets the timeout in seconds for how long to give each source to respond. Real numbers are permitted when setting the timeout, e.g. 0.75, 1.5, .85. The allowed range of seconds is >=0.2 and <=30 (but these extremes are overkill). There is no overall timeout for the script.

The default timeouts are dependant on mode, they are;
.br
Multi mode     -  1 second
.br
Fast mode      -  0.75 seconds
.br
Check mode     -  10 seconds (give it a good chance to succeed.)
.br
Test Url mode  -  10 seconds (give it a good chance to succeed.)

.TP
\fB\-b\fR
Bare output; display only the IP address and not the "IPv4 address:" prefix.

.TP
\fB\-v\fR
Verbose; display detailed information while the script runs.

.TP
\fB\-h\fR, \fB\-\-help\fR
Help; display usage and help.

.TP
\fB\-\-version\fR
Display version number.

.SH EXIT STATUS
getip returns 0 on success, and non-zero on failure.

.SH BUGS

No known bugs.

.SH HOMEPAGE

https://github.com/mattst/getip
.LP
Feel free to submit new IP address providing web pages to be added to the sources list.

.SH AUTHOR

<mattst@i-dig.info>

.SH COPYRIGHT
Copyright <mattst@i-dig.info>, GNU General Public License v.3 or later.
.br
GPLv3+ See: <http://gnu.org/licenses/gpl.html>.
